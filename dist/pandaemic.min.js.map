{"version":3,"sources":["webpack://pandaemic_lib/webpack/bootstrap","webpack://pandaemic_lib/./src/utils.ts","webpack://pandaemic_lib/(webpack)/buildin/global.js","webpack://pandaemic_lib/./node_modules/events/events.js","webpack://pandaemic_lib/./src/boidRules.ts","webpack://pandaemic_lib/./src/pandemic.ts","webpack://pandaemic_lib/./src/grapher.ts","webpack://pandaemic_lib/./src/index.ts","webpack://pandaemic_lib/./src/boids.ts","webpack://pandaemic_lib/./node_modules/timers-browserify/main.js","webpack://pandaemic_lib/./node_modules/setimmediate/setImmediate.js","webpack://pandaemic_lib/./node_modules/process/browser.js","webpack://pandaemic_lib/./src/parametercontrol.ts"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","vec2","x","y","sub","this","add","scl","len","Math","sqrt","norm","fn","a","min","v","max","dot","rect","pos","size","position","center","isInside","point","insideX","insideY","parameter_type","parameter","type","nparam","dependecies","universal_percentage","getParameterByName","_values","entity_scoped","registerDependency","_updateHandler","getValue","push","_randomValue","paramList","emitter","emit","param","length","diff","abs","pop","_updateValues","_i","_a","cb","setImmediate","rnd","random","callback","valueOf","id","universal","setValue","val","setMin","setMax","getParametersByName","params","getParameterByNameOrCreate","_param","getParameters","EventEmitter","g","Function","e","window","ReflectOwnKeys","R","Reflect","ReflectApply","apply","target","receiver","args","ownKeys","getOwnPropertySymbols","getOwnPropertyNames","concat","NumberIsNaN","Number","isNaN","init","_events","undefined","_eventsCount","_maxListeners","defaultMaxListeners","checkListener","listener","TypeError","_getMaxListeners","that","_addListener","prepend","events","existing","warning","newListener","unshift","warned","w","Error","String","count","console","warn","onceWrapper","fired","removeListener","wrapFn","arguments","_onceWrap","state","wrapped","_listeners","unwrap","evlistener","arr","ret","Array","unwrapListeners","arrayClone","listenerCount","copy","set","arg","RangeError","getPrototypeOf","setMaxListeners","getMaxListeners","doError","error","er","err","message","context","handler","listeners","addListener","on","prependListener","once","prependOnceListener","list","originalListener","shift","index","spliceOne","off","removeAllListeners","keys","rawListeners","eventNames","distanceAccelerator","entities","distMatrix","tmp","ii","dvec","dist","vec","extendStatics","__extends","b","setPrototypeOf","__proto__","__","constructor","distanceElement","boidRule","ruleName","log","executeRule","entity","distanceMatrix","weightRule","dir","weightParamNormal","weightParamSick","weightParam","immuneState","sickness_state","sick","socialRule","_super","_this","view_distance","entity_size","nEntities","viewDistance","rule_dir","_entity","randomRule","avoidanceRule","avoidance_distance","avoidanceDistance","sicknessRule","infection_distance","infecting","infection","incubating","infectionDistance","inVirusVicinity","sickness","mortality_rate","infection_rate","incubation_time","healing_time","immune_time","_state","healthy","timer","makeSick","deceased","newstate","onStateUpdated","configurable","update","cured","infectable","graphedVariable","color","values","variableList","appendValue","resetData","event","getGraphVariableByName","vars","variable","getGraphVariableByNameOrCreate","_var","getGraphedVariables","grapher","ctx","legendSize","nRows","dataChanged","updateIntervalID","minVal","maxVal","boundsChanged","width","canvas","height","varUpdatedListener","stepSize","rowSize","margin","yScale","xScale","startUpdateInterval","redrawLegend","addEventListener","setTimeout","resizeEvent","newval","interval","clearInterval","setInterval","clearRect","plotAllGraphVariables","fillStyle","font","strokeStyle","scale","fillText","toFixed","moveTo","lineTo","stroke","idx","offset","y_1","beginPath","arc","PI","fill","translate","variables_1","gv","plotData","data","dataSet","sections","reset","boids","rules","initCanvas","canvasElement","container","canvasContext","getContext","resizeHandler","h","clientHeight","clientWidth","onload","navigator","userAgent","match","document","write","param_container","getElementById","app_window","style","maxHeight","getBoundingClientRect","ParameterController","_initParameterController","be","gr","grapherCanvasElement","_initGrapher","options","boidEngineConfig","maxEntities","maxEntitySize","minEntitySize","fps","boidEngine","randr","addRule","socr","avr","sickr","infectOne","_initPandaemicApplication","btnRestart","onclick","restart","_initControls","continuum","boidRuleConfig","entitiesToBeRemoved","resetInNext","renderIntervalID","updateInterval","_parameterUpdateHandler","eps","entitiesToInfect","bound_size","_hbs","_initBoids","frametime","startRenderInterval","gv_EntitiesAlive","gv_EntitiesInfected","gv_EntitiesSick","gv_EntitesImmune","gv_EntitiesDead","floor","setImmuneSystemState","boidStateUpdateHandler","_generateNewBoid","_x","_y","_pos","_ent","boid","onImmuneSystemStateUpdated","_render","stopRenderInterval","_update","stopUpdateInterval","_rule","clearRules","lineWidth","_updateGraphData","nEntitesMax","nAlive","nInfected","nSick","nImmune","nDead","ent","splice","indexOf","_b","_c","_d","_e","velocity","_size","acceleration","speed","walk_dir","rule","walk_acc","limit","limit_vec_len","new_position","_resolveCollisions","newpos","mindist","resolve_vector","self","Timeout","clearFn","_id","_clearFn","scope","clearTimeout","timeout","close","unref","ref","enroll","item","msecs","_idleTimeoutId","_idleTimeout","unenroll","_unrefActive","active","_onTimeout","global","clearImmediate","registerImmediate","html","channel","messagePrefix","onGlobalMessage","nextHandle","tasksByHandle","currentlyRunningATask","doc","attachTo","toString","process","handle","nextTick","runIfPresent","postMessage","importScripts","postMessageIsAsynchronous","oldOnMessage","onmessage","canUsePostMessage","MessageChannel","port1","port2","createElement","documentElement","script","onreadystatechange","removeChild","appendChild","source","slice","attachEvent","task","run","cachedSetTimeout","cachedClearTimeout","defaultSetTimout","defaultClearTimeout","runTimeout","fun","currentQueue","queue","draining","queueIndex","cleanUpNextTick","drainQueue","marker","runClearTimeout","Item","array","noop","title","browser","env","argv","version","versions","binding","cwd","chdir","umask","ParameterControl","controller","minElement","maxElement","valueSlider","controlledParameter","createUIElement","attachListeners","listElem","className","param_ctrl","innerText","label_min","htmlFor","input_min","br_el","label_max","input_max","param_setpoint","param_slider","addUIElement","_el_1","onchange","parseInt","_el_2","_el_3","parameter_container","parameterAddHandler","controlElements","_ctrl","element"],"mappings":"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","file":"pandaemic.min.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 6);\n","import { EventEmitter } from 'events'\r\n\r\nexport class vec2 {\r\n  x: number\r\n  y: number\r\n\r\n  constructor(x:number|null = 0, y:number|null = 0){\r\n    x = x || 0\r\n    y = y || 0\r\n\r\n    this.x = x\r\n    this.y = y\r\n  }\r\n\r\n  sub(x:number|vec2, y:number = 0):vec2{\r\n    if(typeof x === 'object'){\r\n      return new vec2(this.x - x.x, this.y - x.y)\r\n    }\r\n\r\n    y = y || x\r\n\r\n    return new vec2(this.x - x, this.y - y)\r\n  }\r\n\r\n  add(x:number|vec2, y:number = 0):vec2{\r\n    if(typeof x === 'object'){\r\n      return new vec2(this.x + x.x, this.y + x.y)\r\n    }\r\n\r\n    return new vec2(this.x + x, this.y + y)\r\n  }\r\n\r\n  scl(s:number|vec2 = 0): vec2{\r\n    if(typeof s === 'object'){\r\n      return new vec2(this.x*s.x, this.y*s.y)\r\n    }\r\n\r\n    return new vec2(this.x*s, this.y*s)\r\n  }\r\n\r\n  len():number{\r\n    return Math.sqrt(this.x*this.x + this.y*this.y)\r\n  }\r\n\r\n  norm():vec2{\r\n    let l = this.len()\r\n    if(l === 0) return new vec2(0, 0)\r\n    return new vec2(this.x/l, this.y/l)\r\n  }\r\n\r\n  fn(a:any):vec2{\r\n    return new vec2(a(this.x), a(this.y))\r\n  }\r\n\r\n  min(v: vec2){\r\n    return new vec2(Math.min(this.x, v.x), Math.min(this.x, v.y))\r\n  }\r\n\r\n  max(v: vec2){\r\n    return new vec2(Math.max(this.x, v.x), Math.max(this.x, v.y))\r\n  }\r\n\r\n  dot(v: vec2){\r\n    return this.x*v.x + this.y*v.y\r\n  }\r\n\r\n}\r\n\r\nexport class rect {\r\n  size: vec2\r\n  position: vec2\r\n\r\n  center: vec2\r\n\r\n  constructor(pos: vec2, size: vec2){\r\n    this.position = pos\r\n    this.size = size\r\n\r\n    this.center = this.position.add(this.size).scl(1/2)\r\n  }\r\n\r\n  isInside(point: vec2){\r\n    let insideX = (point.x > this.position.x) && (point.x < (this.position.x + this.size.x))\r\n    let insideY = (point.y > this.position.y) && (point.y < (this.position.y + this.size.y))\r\n    return insideX && insideY\r\n  }\r\n\r\n\r\n}\r\n\r\nexport enum parameter_type {\r\n  universal,\r\n  entity_scoped,\r\n  universal_percentage\r\n}\r\n\r\nexport class parameter {\r\n  static paramList: parameter[] = []\r\n  static emitter: EventEmitter = new EventEmitter()\r\n\r\n  min: number\r\n  max: number\r\n  type: parameter_type\r\n  name: string\r\n\r\n  value: number\r\n  _values: number[]\r\n\r\n  dependecies: any[] = []\r\n\r\n  n: parameter|null\r\n\r\n  constructor(min: number, max:number, type: parameter_type, name: string = 'none', nparam: parameter|null = null){\r\n    if(type === parameter_type.universal_percentage){\r\n      // ignore min / max assignment\r\n      this.min = 0\r\n      this.max = 1\r\n    } else {\r\n      this.min = Math.min(min, max)\r\n      this.max = Math.max(min, max)\r\n    }\r\n\r\n    this.type = type\r\n    this.name = name\r\n\r\n    this.n = nparam || parameter.getParameterByName('nEntities')\r\n\r\n    this.value = (this.max - this.min)/2 + this.min\r\n    this._values = []\r\n    if(this.type === parameter_type.entity_scoped){\r\n      if(this.n){\r\n        this.n.registerDependency(this._updateHandler.bind(this))\r\n        for(let i=0; i<this.n.getValue(); i++){\r\n          this._values.push(this._randomValue())\r\n        }\r\n      }\r\n    }\r\n\r\n    parameter.paramList.push(this)\r\n    // console.log(parameter.paramList)\r\n    parameter.emitter.emit('paramAdded', this)\r\n  }\r\n\r\n  _updateHandler(param: parameter|null = null){\r\n    if(param && param.name === 'nEntities'){\r\n      let n = this._values.length\r\n      let diff = param.getValue() - n\r\n      for(let i=0; i<Math.abs(diff); i++) (diff>0)? this._values.push(0) : this._values.pop()\r\n    }\r\n\r\n    //update all values\r\n    this._updateValues()\r\n\r\n    // pass change event onto dependencies :)\r\n    for(let cb of this.dependecies){\r\n      setImmediate(cb, this)\r\n    }\r\n  }\r\n\r\n  _randomValue(): number{\r\n    let rnd:number = Math.random()\r\n    let val:number = (this.max - this.min)*rnd + this.min\r\n    return val\r\n  }\r\n\r\n  _updateValues(){\r\n    if(this.n){\r\n      for(let i=0; i<this.n.getValue(); i++){\r\n        this._values[i] = this._randomValue()\r\n      }\r\n    }\r\n  }\r\n\r\n  registerDependency(callback: any){\r\n    this.dependecies.push(callback)\r\n  }\r\n\r\n  valueOf(): number{\r\n    return 10\r\n  }\r\n\r\n  getValue(id: number = 0): number {\r\n    switch(this.type){\r\n      case parameter_type.universal:\r\n      case parameter_type.universal_percentage:\r\n        return this.value\r\n      case parameter_type.entity_scoped:\r\n        if(id < 0) id = 0\r\n        if(id >= this._values.length) id = this._values.length-1\r\n        return this._values[id]\r\n    }\r\n    return 0\r\n  }\r\n\r\n  setValue(val: number){\r\n    if(val > this.max) val = this.max\r\n    if(val < this.min) val = this.min\r\n    this.value = val\r\n    this._updateHandler()\r\n  }\r\n\r\n  setMin(val: number){\r\n    this.min = (this.type === parameter_type.universal_percentage)? 0 : val\r\n    this._updateHandler()\r\n  }\r\n\r\n  setMax(val: number){\r\n    this.max = (this.type === parameter_type.universal_percentage)? 1 : val\r\n    this._updateHandler()\r\n  }\r\n\r\n\r\n\r\n\r\n  static getParametersByName(name: string){\r\n    let params:parameter[] = []\r\n    for(let param of parameter.paramList){\r\n      if(param.name === name) params.push(param)\r\n    }\r\n    return params\r\n  }\r\n\r\n  static getParameterByName(name: string): parameter|null{\r\n    return this.getParametersByName(name)[0]\r\n  }\r\n\r\n  static getParameterByNameOrCreate(name: string, type:parameter_type=parameter_type.entity_scoped, min:number=0, max:number= 1): parameter{\r\n    let _param = this.getParametersByName(name)[0]\r\n    if(!_param){\r\n      _param = new parameter(min, max, type, name)\r\n    }\r\n\r\n    return _param\r\n  }\r\n\r\n  static getParameters(){\r\n    return parameter.paramList\r\n  }\r\n\r\n}\r\n","var g;\n\n// This works in non-strict mode\ng = (function() {\n\treturn this;\n})();\n\ntry {\n\t// This works if eval is allowed (see CSP)\n\tg = g || new Function(\"return this\")();\n} catch (e) {\n\t// This works if the window reference is available\n\tif (typeof window === \"object\") g = window;\n}\n\n// g can still be undefined, but nothing to do about it...\n// We return undefined, instead of nothing here, so it's\n// easier to handle this case. if(!global) { ...}\n\nmodule.exports = g;\n","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n'use strict';\n\nvar R = typeof Reflect === 'object' ? Reflect : null\nvar ReflectApply = R && typeof R.apply === 'function'\n  ? R.apply\n  : function ReflectApply(target, receiver, args) {\n    return Function.prototype.apply.call(target, receiver, args);\n  }\n\nvar ReflectOwnKeys\nif (R && typeof R.ownKeys === 'function') {\n  ReflectOwnKeys = R.ownKeys\n} else if (Object.getOwnPropertySymbols) {\n  ReflectOwnKeys = function ReflectOwnKeys(target) {\n    return Object.getOwnPropertyNames(target)\n      .concat(Object.getOwnPropertySymbols(target));\n  };\n} else {\n  ReflectOwnKeys = function ReflectOwnKeys(target) {\n    return Object.getOwnPropertyNames(target);\n  };\n}\n\nfunction ProcessEmitWarning(warning) {\n  if (console && console.warn) console.warn(warning);\n}\n\nvar NumberIsNaN = Number.isNaN || function NumberIsNaN(value) {\n  return value !== value;\n}\n\nfunction EventEmitter() {\n  EventEmitter.init.call(this);\n}\nmodule.exports = EventEmitter;\n\n// Backwards-compat with node 0.10.x\nEventEmitter.EventEmitter = EventEmitter;\n\nEventEmitter.prototype._events = undefined;\nEventEmitter.prototype._eventsCount = 0;\nEventEmitter.prototype._maxListeners = undefined;\n\n// By default EventEmitters will print a warning if more than 10 listeners are\n// added to it. This is a useful default which helps finding memory leaks.\nvar defaultMaxListeners = 10;\n\nfunction checkListener(listener) {\n  if (typeof listener !== 'function') {\n    throw new TypeError('The \"listener\" argument must be of type Function. Received type ' + typeof listener);\n  }\n}\n\nObject.defineProperty(EventEmitter, 'defaultMaxListeners', {\n  enumerable: true,\n  get: function() {\n    return defaultMaxListeners;\n  },\n  set: function(arg) {\n    if (typeof arg !== 'number' || arg < 0 || NumberIsNaN(arg)) {\n      throw new RangeError('The value of \"defaultMaxListeners\" is out of range. It must be a non-negative number. Received ' + arg + '.');\n    }\n    defaultMaxListeners = arg;\n  }\n});\n\nEventEmitter.init = function() {\n\n  if (this._events === undefined ||\n      this._events === Object.getPrototypeOf(this)._events) {\n    this._events = Object.create(null);\n    this._eventsCount = 0;\n  }\n\n  this._maxListeners = this._maxListeners || undefined;\n};\n\n// Obviously not all Emitters should be limited to 10. This function allows\n// that to be increased. Set to zero for unlimited.\nEventEmitter.prototype.setMaxListeners = function setMaxListeners(n) {\n  if (typeof n !== 'number' || n < 0 || NumberIsNaN(n)) {\n    throw new RangeError('The value of \"n\" is out of range. It must be a non-negative number. Received ' + n + '.');\n  }\n  this._maxListeners = n;\n  return this;\n};\n\nfunction _getMaxListeners(that) {\n  if (that._maxListeners === undefined)\n    return EventEmitter.defaultMaxListeners;\n  return that._maxListeners;\n}\n\nEventEmitter.prototype.getMaxListeners = function getMaxListeners() {\n  return _getMaxListeners(this);\n};\n\nEventEmitter.prototype.emit = function emit(type) {\n  var args = [];\n  for (var i = 1; i < arguments.length; i++) args.push(arguments[i]);\n  var doError = (type === 'error');\n\n  var events = this._events;\n  if (events !== undefined)\n    doError = (doError && events.error === undefined);\n  else if (!doError)\n    return false;\n\n  // If there is no 'error' event listener then throw.\n  if (doError) {\n    var er;\n    if (args.length > 0)\n      er = args[0];\n    if (er instanceof Error) {\n      // Note: The comments on the `throw` lines are intentional, they show\n      // up in Node's output if this results in an unhandled exception.\n      throw er; // Unhandled 'error' event\n    }\n    // At least give some kind of context to the user\n    var err = new Error('Unhandled error.' + (er ? ' (' + er.message + ')' : ''));\n    err.context = er;\n    throw err; // Unhandled 'error' event\n  }\n\n  var handler = events[type];\n\n  if (handler === undefined)\n    return false;\n\n  if (typeof handler === 'function') {\n    ReflectApply(handler, this, args);\n  } else {\n    var len = handler.length;\n    var listeners = arrayClone(handler, len);\n    for (var i = 0; i < len; ++i)\n      ReflectApply(listeners[i], this, args);\n  }\n\n  return true;\n};\n\nfunction _addListener(target, type, listener, prepend) {\n  var m;\n  var events;\n  var existing;\n\n  checkListener(listener);\n\n  events = target._events;\n  if (events === undefined) {\n    events = target._events = Object.create(null);\n    target._eventsCount = 0;\n  } else {\n    // To avoid recursion in the case that type === \"newListener\"! Before\n    // adding it to the listeners, first emit \"newListener\".\n    if (events.newListener !== undefined) {\n      target.emit('newListener', type,\n                  listener.listener ? listener.listener : listener);\n\n      // Re-assign `events` because a newListener handler could have caused the\n      // this._events to be assigned to a new object\n      events = target._events;\n    }\n    existing = events[type];\n  }\n\n  if (existing === undefined) {\n    // Optimize the case of one listener. Don't need the extra array object.\n    existing = events[type] = listener;\n    ++target._eventsCount;\n  } else {\n    if (typeof existing === 'function') {\n      // Adding the second element, need to change to array.\n      existing = events[type] =\n        prepend ? [listener, existing] : [existing, listener];\n      // If we've already got an array, just append.\n    } else if (prepend) {\n      existing.unshift(listener);\n    } else {\n      existing.push(listener);\n    }\n\n    // Check for listener leak\n    m = _getMaxListeners(target);\n    if (m > 0 && existing.length > m && !existing.warned) {\n      existing.warned = true;\n      // No error code for this since it is a Warning\n      // eslint-disable-next-line no-restricted-syntax\n      var w = new Error('Possible EventEmitter memory leak detected. ' +\n                          existing.length + ' ' + String(type) + ' listeners ' +\n                          'added. Use emitter.setMaxListeners() to ' +\n                          'increase limit');\n      w.name = 'MaxListenersExceededWarning';\n      w.emitter = target;\n      w.type = type;\n      w.count = existing.length;\n      ProcessEmitWarning(w);\n    }\n  }\n\n  return target;\n}\n\nEventEmitter.prototype.addListener = function addListener(type, listener) {\n  return _addListener(this, type, listener, false);\n};\n\nEventEmitter.prototype.on = EventEmitter.prototype.addListener;\n\nEventEmitter.prototype.prependListener =\n    function prependListener(type, listener) {\n      return _addListener(this, type, listener, true);\n    };\n\nfunction onceWrapper() {\n  if (!this.fired) {\n    this.target.removeListener(this.type, this.wrapFn);\n    this.fired = true;\n    if (arguments.length === 0)\n      return this.listener.call(this.target);\n    return this.listener.apply(this.target, arguments);\n  }\n}\n\nfunction _onceWrap(target, type, listener) {\n  var state = { fired: false, wrapFn: undefined, target: target, type: type, listener: listener };\n  var wrapped = onceWrapper.bind(state);\n  wrapped.listener = listener;\n  state.wrapFn = wrapped;\n  return wrapped;\n}\n\nEventEmitter.prototype.once = function once(type, listener) {\n  checkListener(listener);\n  this.on(type, _onceWrap(this, type, listener));\n  return this;\n};\n\nEventEmitter.prototype.prependOnceListener =\n    function prependOnceListener(type, listener) {\n      checkListener(listener);\n      this.prependListener(type, _onceWrap(this, type, listener));\n      return this;\n    };\n\n// Emits a 'removeListener' event if and only if the listener was removed.\nEventEmitter.prototype.removeListener =\n    function removeListener(type, listener) {\n      var list, events, position, i, originalListener;\n\n      checkListener(listener);\n\n      events = this._events;\n      if (events === undefined)\n        return this;\n\n      list = events[type];\n      if (list === undefined)\n        return this;\n\n      if (list === listener || list.listener === listener) {\n        if (--this._eventsCount === 0)\n          this._events = Object.create(null);\n        else {\n          delete events[type];\n          if (events.removeListener)\n            this.emit('removeListener', type, list.listener || listener);\n        }\n      } else if (typeof list !== 'function') {\n        position = -1;\n\n        for (i = list.length - 1; i >= 0; i--) {\n          if (list[i] === listener || list[i].listener === listener) {\n            originalListener = list[i].listener;\n            position = i;\n            break;\n          }\n        }\n\n        if (position < 0)\n          return this;\n\n        if (position === 0)\n          list.shift();\n        else {\n          spliceOne(list, position);\n        }\n\n        if (list.length === 1)\n          events[type] = list[0];\n\n        if (events.removeListener !== undefined)\n          this.emit('removeListener', type, originalListener || listener);\n      }\n\n      return this;\n    };\n\nEventEmitter.prototype.off = EventEmitter.prototype.removeListener;\n\nEventEmitter.prototype.removeAllListeners =\n    function removeAllListeners(type) {\n      var listeners, events, i;\n\n      events = this._events;\n      if (events === undefined)\n        return this;\n\n      // not listening for removeListener, no need to emit\n      if (events.removeListener === undefined) {\n        if (arguments.length === 0) {\n          this._events = Object.create(null);\n          this._eventsCount = 0;\n        } else if (events[type] !== undefined) {\n          if (--this._eventsCount === 0)\n            this._events = Object.create(null);\n          else\n            delete events[type];\n        }\n        return this;\n      }\n\n      // emit removeListener for all listeners on all events\n      if (arguments.length === 0) {\n        var keys = Object.keys(events);\n        var key;\n        for (i = 0; i < keys.length; ++i) {\n          key = keys[i];\n          if (key === 'removeListener') continue;\n          this.removeAllListeners(key);\n        }\n        this.removeAllListeners('removeListener');\n        this._events = Object.create(null);\n        this._eventsCount = 0;\n        return this;\n      }\n\n      listeners = events[type];\n\n      if (typeof listeners === 'function') {\n        this.removeListener(type, listeners);\n      } else if (listeners !== undefined) {\n        // LIFO order\n        for (i = listeners.length - 1; i >= 0; i--) {\n          this.removeListener(type, listeners[i]);\n        }\n      }\n\n      return this;\n    };\n\nfunction _listeners(target, type, unwrap) {\n  var events = target._events;\n\n  if (events === undefined)\n    return [];\n\n  var evlistener = events[type];\n  if (evlistener === undefined)\n    return [];\n\n  if (typeof evlistener === 'function')\n    return unwrap ? [evlistener.listener || evlistener] : [evlistener];\n\n  return unwrap ?\n    unwrapListeners(evlistener) : arrayClone(evlistener, evlistener.length);\n}\n\nEventEmitter.prototype.listeners = function listeners(type) {\n  return _listeners(this, type, true);\n};\n\nEventEmitter.prototype.rawListeners = function rawListeners(type) {\n  return _listeners(this, type, false);\n};\n\nEventEmitter.listenerCount = function(emitter, type) {\n  if (typeof emitter.listenerCount === 'function') {\n    return emitter.listenerCount(type);\n  } else {\n    return listenerCount.call(emitter, type);\n  }\n};\n\nEventEmitter.prototype.listenerCount = listenerCount;\nfunction listenerCount(type) {\n  var events = this._events;\n\n  if (events !== undefined) {\n    var evlistener = events[type];\n\n    if (typeof evlistener === 'function') {\n      return 1;\n    } else if (evlistener !== undefined) {\n      return evlistener.length;\n    }\n  }\n\n  return 0;\n}\n\nEventEmitter.prototype.eventNames = function eventNames() {\n  return this._eventsCount > 0 ? ReflectOwnKeys(this._events) : [];\n};\n\nfunction arrayClone(arr, n) {\n  var copy = new Array(n);\n  for (var i = 0; i < n; ++i)\n    copy[i] = arr[i];\n  return copy;\n}\n\nfunction spliceOne(list, index) {\n  for (; index + 1 < list.length; index++)\n    list[index] = list[index + 1];\n  list.pop();\n}\n\nfunction unwrapListeners(arr) {\n  var ret = new Array(arr.length);\n  for (var i = 0; i < ret.length; ++i) {\n    ret[i] = arr[i].listener || arr[i];\n  }\n  return ret;\n}\n","import { boid } from './boids'\r\nimport { vec2, rect, parameter, parameter_type } from './utils'\r\nimport { sickness, sickness_state } from './pandemic'\r\n\r\nexport class distanceElement{\r\n  dist: number = 0\r\n  vec: vec2 = new vec2()\r\n}\r\n\r\nexport function distanceAccelerator(entities: boid[]): distanceElement[][]{\r\n  let n = entities.length\r\n  let distMatrix: distanceElement [][] = []\r\n\r\n\r\n  let tmp: distanceElement[] = []\r\n  for(let i=0; i<n; i++){\r\n    tmp = []\r\n    // for(let ii=0; ii<n; ii++){\r\n    //   tmp.push({dist: 0, vec: new vec2()})\r\n    // }\r\n    distMatrix.push(tmp)\r\n  }\r\n\r\n  for(let i=0; i<n; i++){\r\n    for(let ii=i; ii<n; ii++){\r\n      let dvec = entities[i].position.sub(entities[ii].position)\r\n      let dist = dvec.len()\r\n      distMatrix[i][ii] = {dist:dist, vec: dvec}\r\n      distMatrix[ii][i] = {dist:dist, vec: dvec.scl(-1)}\r\n    }\r\n  }\r\n  return distMatrix\r\n}\r\n\r\nexport class boidRule {\r\n  ruleName: string;\r\n\r\n  constructor(name:string){\r\n    this.ruleName = name;\r\n    console.log('Constructed new rule w/ name:', name)\r\n  }\r\n\r\n  executeRule(entity: boid, entities: boid[], distanceMatrix:distanceElement[][]): vec2{\r\n    console.log('Excuting base rule :)')\r\n    return new vec2()\r\n  }\r\n\r\n  weightRule(dir: vec2, entity: boid): vec2{\r\n    let weightParamNormal = parameter.getParameterByNameOrCreate(`${this.ruleName} weight`)\r\n    let weightParamSick = parameter.getParameterByNameOrCreate(`${this.ruleName} weight (sick)`)\r\n\r\n    let weightParam = (entity.immuneState === sickness_state.sick)? weightParamSick : weightParamNormal\r\n    return dir.scl(weightParam.getValue(entity.id))\r\n  }\r\n\r\n}\r\n\r\nexport class socialRule extends boidRule{\r\n\r\n  view_distance: parameter\r\n  entity_size: parameter\r\n\r\n  constructor(){\r\n    super('SocialRule')\r\n    this.view_distance = parameter.getParameterByNameOrCreate('View Distance', parameter_type.universal, 10, 30)\r\n    this.entity_size = parameter.getParameterByNameOrCreate('EntitySize', parameter_type.universal, 4, 8)\r\n  }\r\n\r\n  executeRule(entity: boid, entities: boid[], distanceMatrix:distanceElement[][]): vec2 {\r\n    let nEntities = distanceMatrix.length\r\n    let viewDistance = this.view_distance.getValue()\r\n\r\n    let rule_dir = new vec2()\r\n    for(let i:number=0; i<nEntities; i++){\r\n      let _entity = entities[i]\r\n      if(entity === _entity) continue\r\n      //let distEl = distanceMatrix[entity.id][i]\r\n      let dist = entity.position.sub(_entity.position)\r\n      if(dist.len() < viewDistance){\r\n        // if(dist <= this.entity_size.getValue(id)*1.2) continue\r\n        rule_dir = rule_dir.add(dist.fn((e:number) => 1/e))\r\n      }\r\n    }\r\n    return rule_dir.norm()\r\n  }\r\n\r\n}\r\n\r\nexport class randomRule extends boidRule{\r\n\r\n  constructor(){\r\n    super('randomRule')\r\n  }\r\n\r\n  executeRule(entity: boid, entities: boid[], distanceMatrix:distanceElement[][]): vec2 {\r\n    let x = (Math.random() - 0.5) * 2\r\n    let y = (Math.random() - 0.5) * 2\r\n\r\n    let rule_dir = new vec2(x, y)\r\n    return rule_dir.norm()\r\n}\r\n\r\n}\r\n\r\nexport class avoidanceRule extends boidRule{\r\n  avoidance_distance: parameter;\r\n\r\n\r\n  constructor(){\r\n    super('avoidanceRule')\r\n\r\n    this.avoidance_distance = parameter.getParameterByNameOrCreate('Avoidance Distance', parameter_type.universal, 10, 30)\r\n\r\n  }\r\n\r\n  executeRule(entity:boid, entities: boid[], distanceMatrix:distanceElement[][]): vec2 {\r\n    let nEntities: number = distanceMatrix.length\r\n\r\n    let avoidanceDistance = this.avoidance_distance.getValue()\r\n\r\n    let rule_dir: vec2 = new vec2()\r\n\r\n    // TODO extract this into new method.\r\n    for(let i=0; i<nEntities; i++){\r\n      let _entity = entities[i]\r\n      if(entity === _entity) continue\r\n      //let distEl = distanceMatrix[entity.id][i]\r\n      let dist = _entity.position.sub(entity.position)\r\n      if(dist.len() < avoidanceDistance){\r\n        rule_dir = rule_dir.add(dist.fn((e:number) => 100 * 1/e))\r\n      }\r\n    }\r\n\r\n    return rule_dir.norm()\r\n  }\r\n\r\n}\r\n\r\n/*\r\nThis rule does not return a distance, but abuses the rule interface to handle infections...\r\n*/\r\nexport class sicknessRule extends boidRule{\r\n  infection_distance: parameter;\r\n\r\n  constructor(){\r\n    super('sicknessRule')\r\n    this.infection_distance = parameter.getParameterByNameOrCreate('Infection Distance', parameter_type.universal, 10, 15)\r\n  }\r\n\r\n  weightRule(dir: vec2, entity: boid): vec2{\r\n    return dir;\r\n  }\r\n\r\n  executeRule(entity: boid, entities: boid[], distanceMatrix:distanceElement[][]): vec2 {\r\n\r\n    let nEntities: number = distanceMatrix.length\r\n\r\n    let infecting = entity.infection.state === sickness_state.incubating || entity.infection.state === sickness_state.sick\r\n\r\n    let infectionDistance = this.infection_distance.getValue()\r\n\r\n    // TODO extract this into new method.\r\n    for(let i=0; i<nEntities; i++){\r\n      let _entity = entities[i]\r\n      if(entity === _entity) continue\r\n      //let distEl = distanceMatrix[entity.id][i]\r\n      let dist = entity.position.sub(_entity.position)\r\n\r\n      // let distEl: distanceElement = distanceMatrix[id][i]\r\n      if(dist.len() < infectionDistance && infecting){\r\n        // possibly infect the other boid...\r\n        let otherEntity = entities[i]\r\n        otherEntity.inVirusVicinity()\r\n      }\r\n    }\r\n\r\n    return new vec2()\r\n  }\r\n\r\n}\r\n","import { parameter, parameter_type } from './utils'\r\n\r\nexport enum sickness_state {\r\n  healthy,\r\n  incubating,\r\n  sick,\r\n  deceased,\r\n  cured\r\n}\r\n\r\nexport class sickness {\r\n  mortality_rate: parameter\r\n  infection_rate: parameter\r\n  incubation_time: parameter\r\n  healing_time: parameter\r\n  immune_time: parameter\r\n\r\n  _state: sickness_state\r\n  timer: number;\r\n\r\n  onStateUpdated: any|null;\r\n\r\n  constructor(){\r\n    this.mortality_rate = parameter.getParameterByNameOrCreate('Mortality Rate', parameter_type.universal_percentage)\r\n    this.infection_rate = parameter.getParameterByNameOrCreate('Infection Rate', parameter_type.universal_percentage)\r\n    this.incubation_time = parameter.getParameterByNameOrCreate('Incubation Time', parameter_type.universal, 0, 100)\r\n    this.healing_time = parameter.getParameterByNameOrCreate('Healing Time', parameter_type.universal, 0, 100)\r\n    this.immune_time = parameter.getParameterByNameOrCreate('Immune Time', parameter_type.universal, 0, 100)\r\n\r\n    this._state = sickness_state.healthy\r\n    this.timer = 0\r\n  }\r\n\r\n  makeSick(){\r\n    if(this.state !== sickness_state.deceased){\r\n      this.state = sickness_state.sick;\r\n    }\r\n  }\r\n\r\n  set state(newstate: sickness_state){\r\n    this._state = newstate\r\n    if(this.onStateUpdated) this.onStateUpdated(this._state)\r\n  }\r\n\r\n  get state(){\r\n    return this._state\r\n  }\r\n\r\n  update(diff: number){\r\n    switch(this.state){\r\n      case sickness_state.healthy:\r\n        // do nothing :)\r\n      break;\r\n      case sickness_state.incubating:\r\n        this.timer += diff\r\n        if(this.timer > this.incubation_time.getValue()*1000){\r\n          this.state = sickness_state.sick\r\n          this.timer = 0\r\n        }\r\n      break;\r\n      case sickness_state.sick:\r\n        this.timer += diff\r\n        if(this.timer > this.healing_time.getValue()*1000){\r\n          let rnd = Math.random()\r\n          if(rnd > this.mortality_rate.getValue()){\r\n            this.state = sickness_state.healthy\r\n          }else{\r\n            this.state = sickness_state.deceased\r\n          }\r\n          this.timer = 0\r\n        }\r\n      break;\r\n      case sickness_state.deceased:\r\n        // can't do anything :)\r\n      break;\r\n      case sickness_state.cured:\r\n        this.timer += diff\r\n        if(this.timer > this.immune_time.getValue()*1000){\r\n          this.state = sickness_state.healthy\r\n          this.timer = 0\r\n        }\r\n      break;\r\n    }\r\n  }\r\n\r\n  get infectable() {\r\n    return this._state === sickness_state.healthy\r\n  }\r\n\r\n  inVirusVicinity(){\r\n    if(!this.infectable) return\r\n    let _rnd = Math.random()\r\n    if(_rnd <= this.infection_rate.getValue()){\r\n      this.state = sickness_state.incubating\r\n    }\r\n  }\r\n\r\n\r\n\r\n}\r\n","import { vec2 } from './utils'\r\nimport { EventEmitter } from 'events'\r\n\r\ntype timerHandle = number;\r\n\r\nexport class graphedVariable {\r\n  static variableList: graphedVariable[] = []\r\n  static emitter: EventEmitter = new EventEmitter()\r\n\r\n  name: string\r\n  color: string\r\n\r\n  values: number[]\r\n  n: number\r\n\r\n  constructor(name: string = 'none', color: string = '#000'){\r\n    this.name = name\r\n    this.color = color\r\n\r\n    this.n = 0\r\n    this.values = []\r\n\r\n    graphedVariable.variableList.push(this)\r\n    // console.log(parameter.paramList)\r\n    graphedVariable.emitter.emit('paramAdded', this)\r\n  }\r\n\r\n  appendValue(val: number){\r\n    this.values.push(val)\r\n    graphedVariable.emitter.emit('variableUpdated', val, this)\r\n  }\r\n\r\n  get data(){\r\n    // TODO add preprocessing?\r\n    return this.values\r\n  }\r\n\r\n  resetData(){\r\n    this.n = 0\r\n    this.values = []\r\n  }\r\n\r\n  static on(event: string, callback: any){\r\n    graphedVariable.emitter.on(event, callback)\r\n  }\r\n\r\n  static getGraphVariableByName(name: string): graphedVariable|null{\r\n    let vars: graphedVariable[] = []\r\n    for(let variable of graphedVariable.variableList){\r\n      if(variable.name === name) vars.push(variable)\r\n    }\r\n\r\n    if(vars.length === 0) return null\r\n    return vars[0]\r\n  }\r\n\r\n  static getGraphVariableByNameOrCreate(name: string, color: string): graphedVariable{\r\n    let _var = this.getGraphVariableByName(name)\r\n    if(!_var){\r\n      _var = new graphedVariable(name, color)\r\n    }\r\n    return _var\r\n  }\r\n\r\n  static getGraphedVariables(){\r\n    return graphedVariable.variableList\r\n  }\r\n\r\n}\r\n\r\n\r\nexport class grapher{\r\n  values: number[][]\r\n  ctx: CanvasRenderingContext2D\r\n  size: vec2\r\n\r\n  maxVal: number\r\n  minVal: number\r\n  boundsChanged: boolean\r\n\r\n  xScale: number\r\n  yScale: number\r\n  stepSize: number\r\n  margin: number\r\n  rowSize: number\r\n\r\n  legendSize: number = 50\r\n  nRows = 4\r\n\r\n  dataChanged: boolean = true\r\n\r\n  updateIntervalID: timerHandle|null = null\r\n\r\n  constructor(ctx: CanvasRenderingContext2D){\r\n    this.values = []\r\n    this.ctx = ctx\r\n\r\n    this.minVal = 0\r\n    this.maxVal =  1\r\n    this.boundsChanged = true\r\n\r\n    let width:number = this.ctx.canvas.width\r\n    let height:number = this.ctx.canvas.height\r\n\r\n    this.size = new vec2(width, height)\r\n    graphedVariable.on('variableUpdated', this.varUpdatedListener.bind(this))\r\n\r\n    // set these values for your data\r\n    let sections = 12;\r\n    this.stepSize = 40;\r\n    this.rowSize = 50;\r\n    this.margin = 10;\r\n\r\n    this.yScale = (this.size.y - 2*this.margin) / (this.maxVal - this.minVal);\r\n    this.xScale = (this.size.x - this.rowSize) / sections;\r\n\r\n    this.startUpdateInterval(100)\r\n\r\n    this.redrawLegend()\r\n    window.addEventListener('resize', () => setTimeout(this.resizeEvent.bind(this), 10))\r\n  }\r\n\r\n  resizeEvent(){\r\n    let width:number = this.ctx.canvas.width\r\n    let height:number = this.ctx.canvas.height\r\n\r\n    this.size = new vec2(width, height)\r\n    this.yScale = (this.size.y - 2*this.margin) / (this.maxVal - this.minVal);\r\n  }\r\n\r\n  varUpdatedListener(newval: number, _var: any): void {\r\n    if(newval < this.minVal){\r\n      this.minVal = newval\r\n      this.boundsChanged = true\r\n    }\r\n    if(newval > this.maxVal){\r\n      this.maxVal = newval\r\n      this.boundsChanged = true\r\n    }\r\n    this.dataChanged = true\r\n  }\r\n\r\n  startUpdateInterval(interval: number){\r\n    if(this.updateIntervalID !== null){\r\n      clearInterval(this.updateIntervalID)\r\n    }\r\n    this.updateIntervalID = setInterval(this.update.bind(this), interval) as unknown as number\r\n  }\r\n\r\n  update(){\r\n    if(!this.dataChanged) return\r\n    this.ctx.clearRect(0, 0, this.ctx.canvas.width, this.ctx.canvas.height);\r\n    if(this.boundsChanged){\r\n      this.yScale = (this.size.y - 2*this.margin) / (this.maxVal - this.minVal);\r\n      // this.xScale = (this.size.x - this.rowSize) / sections;\r\n      this.boundsChanged = false\r\n    }\r\n\r\n    this.redrawLegend()\r\n    this.plotAllGraphVariables()\r\n    // console.log(this)\r\n    this.dataChanged = false\r\n  }\r\n\r\n  redrawLegend(){\r\n    this.ctx.fillStyle = \"#997f89\"\r\n    this.ctx.font = '10pt Oswald'\r\n\r\n    let stepSize = (this.maxVal - this.minVal) / this.nRows\r\n    // print row header and draw horizontal grid lines\r\n    var count =  0;\r\n    this.ctx.strokeStyle=\"#997f89\"; // color of grid lines\r\n    for (let scale=this.maxVal; scale>=this.minVal; scale = scale - stepSize) {\r\n      var y = this.margin + (this.yScale * count * stepSize);\r\n\r\n      this.ctx.fillText(scale.toFixed(1), this.margin, y + this.margin/2);\r\n      this.ctx.moveTo(this.legendSize + 90 ,y)\r\n      this.ctx.lineTo(this.size.x - this.margin,y)\r\n      count++;\r\n    }\r\n    this.ctx.stroke();\r\n\r\n    let idx = 0\r\n    let offset = (this.size.y - 2*this.margin) - graphedVariable.getGraphedVariables().length * 25\r\n    for (let _var of graphedVariable.variableList){\r\n      this.ctx.fillStyle = _var.color\r\n      // this.ctx.fillText(_var.name, this.margin, 20);\r\n      this.ctx.fillStyle = '#292c2e'\r\n      let y = offset + this.margin + idx*25\r\n      this.ctx.fillText(_var.name, this.margin + this.legendSize, y);\r\n      this.ctx.fillStyle = _var.color\r\n      this.ctx.beginPath();\r\n      this.ctx.arc(this.margin - 8 + this.legendSize,  y - 4, 4, 0, 2 * Math.PI, false);\r\n      this.ctx.fill()\r\n      idx ++\r\n    }\r\n  }\r\n\r\n  plotAllGraphVariables(){\r\n    this.ctx.translate(this.legendSize, 0);\r\n    let variables = graphedVariable.getGraphedVariables()\r\n    for(let gv of variables){\r\n      this.ctx.strokeStyle = gv.color\r\n      this.plotData(gv.data)\r\n    }\r\n    this.ctx.translate(-this.legendSize, 0);\r\n  }\r\n\r\n  plotData(dataSet: number[]) {\r\n    let sections = dataSet.length\r\n    // let rowsize = this.size.x / sections\r\n    let xScale = this.size.x / sections;\r\n    this.ctx.beginPath();\r\n    this.ctx.moveTo(0, this.yScale * (this.maxVal - dataSet[0]) + this.margin);\r\n    for (let i=1;i<sections;i++) {\r\n      this.ctx.lineTo(i * xScale, this.yScale * (this.maxVal - dataSet[i]) + this.margin);\r\n    }\r\n    this.ctx.stroke();\r\n    }\r\n\r\n  reset(){\r\n    this.minVal = 0\r\n    this.maxVal =  1\r\n    this.yScale = (this.size.y - 2*this.margin) / (this.maxVal - this.minVal);\r\n  }\r\n}\r\n","import * as boids from \"./boids\";\nimport * as rules from \"./boidRules\"\nimport { vec2, rect, parameter, parameter_type } from './utils'\nimport { ParameterController } from './parametercontrol'\nimport { grapher } from './grapher'\n\n\n\nlet initCanvas = (canvasElement: HTMLCanvasElement, container: HTMLElement) => {\n  let canvasContext: CanvasRenderingContext2D|null = canvasElement.getContext('2d');\n\n  let resizeHandler = () => {\n    let h = canvasElement.clientHeight\n    canvasElement.height = h\n    let w = canvasElement.clientWidth\n    canvasElement.width = w\n    if(canvasContext){\n      canvasContext.canvas.width  = w;\n      canvasContext.canvas.height = h;\n    }\n\n  }\n\n  window.addEventListener('resize', resizeHandler);\n\n  resizeHandler()\n\n  return canvasContext\n}\n\nlet _initPandaemicApplication = (canvas: HTMLCanvasElement) => {\n  let container: HTMLElement|null = document.getElementById('be_canvas_container')\n  if(!container) return\n  let ctx = initCanvas(canvas, container)\n  if(!ctx) return\n\n  let options = new boids.boidEngineConfig()\n  options.maxEntities = 200\n  options.maxEntitySize = 8\n  options.minEntitySize = 8\n  options.fps = 25\n\n  let be = new boids.boidEngine(ctx, options)\n\n  let randr = new rules.randomRule()\n  be.addRule(randr)\n\n  let socr = new rules.socialRule();\n  be.addRule(socr)\n\n  let avr = new rules.avoidanceRule()\n  be.addRule(avr)\n\n  let sickr = new rules.sicknessRule()\n  be.addRule(sickr)\n\n  window.infectOne = be.infectOne.bind(be)\n\n  // be.startRenderInterval(100)\n  // setInterval(be.reset.bind(be), 1000)\n  return be\n}\n\nlet _initParameterController = () => {\n  let param_container = document.getElementById('p_container')\n  let app_window = document.getElementById('window')\n\n\n  if(param_container && app_window){\n    param_container.style.maxHeight = 0.95*app_window.getBoundingClientRect().height + 'px';\n    let _ctrl = new ParameterController(param_container)\n  }\n}\n\nlet _initGrapher = (canvas: HTMLCanvasElement) => {\n\n  let container: HTMLElement|null = document.getElementById('graph_canvas_container')\n  if(!container) return\n\n  let ctx = initCanvas(canvas, container)\n  if(!ctx) return\n  let _grapher = new grapher(ctx)\n  return _grapher\n}\n\nlet _initControls = (be: boids.boidEngine, gr: grapher) => {\n  let btnRestart: HTMLElement|null = document.getElementById('btn_restart')\n  if(btnRestart){\n    btnRestart.onclick = () => {\n      if(!btnRestart) return\n      be.restart()\n      gr.reset()\n    }\n  }\n}\n\nlet main = () => {\n  /* This is a fix for CSS-Scaling on PCs */\n  if(navigator.userAgent.match(/Android/i)\n  || navigator.userAgent.match(/webOS/i)\n  || navigator.userAgent.match(/iPhone/i)\n  || navigator.userAgent.match(/iPad/i)\n  || navigator.userAgent.match(/iPod/i)\n  || navigator.userAgent.match(/BlackBerry/i)\n  || navigator.userAgent.match(/Windows Phone/i)) {\n    console.log('Running on mobile, not applying viewport fix.')\n  }else{\n    document.write('<meta name=\"viewport\" content=\"width=device-width, height=device-height, initial-scale=1\">');\n  }\n\n  _initParameterController()\n\n  let be = null, gr = null\n\n  //get the grapher canvas element\n  let grapherCanvasElement: HTMLCanvasElement|null = document.getElementById('graph_canvas') as HTMLCanvasElement\n  if(grapherCanvasElement) gr = _initGrapher(grapherCanvasElement)\n\n  // get the canvas element\n  let canvasElement: HTMLCanvasElement|null = document.getElementById('canvas') as HTMLCanvasElement\n  if(canvasElement) be = _initPandaemicApplication(canvasElement)\n\n  if(be && gr){\n    _initControls(be, gr)\n  }\n\n  /*\n  for(let i=0; i<20; i++){\n    let param = new parameter(0, 1, parameter_type.universal, `rule_${i}`)\n  }\n  */\n\n}\n\nwindow.onload = main\n","import { vec2, rect, parameter, parameter_type } from \"./utils\";\r\nimport { boidRule, distanceAccelerator, distanceElement} from './boidRules'\r\nimport { sickness, sickness_state } from './pandemic'\r\n\r\nimport { graphedVariable } from './grapher'\r\n\r\ntype timerHandle = number;\r\n\r\nexport class boidEngineConfig {\r\n  maxEntities: number = 500;\r\n  minEntitySize: number = 3;\r\n  maxEntitySize: number = 3;\r\n\r\n  fps: number|null = null;\r\n\r\n  continuum: boolean = true;\r\n}\r\n\r\nexport class boidRuleConfig {\r\n\r\n}\r\n\r\nexport class boidEngine {\r\n\r\n  nEntities: parameter\r\n  ctx: CanvasRenderingContext2D\r\n\r\n  size: vec2\r\n  bound_size: vec2\r\n  _hbs: vec2\r\n\r\n  entity_size: parameter\r\n\r\n  entities: boid[]\r\n  entitiesToBeRemoved: boid[] = []\r\n  resetInNext: boolean = false\r\n\r\n  renderIntervalID: timerHandle|null = null\r\n  updateIntervalID: timerHandle|null = null\r\n  updateInterval: number = 0;\r\n\r\n  entitiesToInfect: parameter\r\n\r\n  rules: boidRule[] = []\r\n\r\n  continuum: boolean;\r\n\r\n  // graphed data:\r\n  gv_EntitiesAlive: graphedVariable\r\n  gv_EntitiesInfected: graphedVariable\r\n  gv_EntitiesSick: graphedVariable\r\n  gv_EntitesImmune: graphedVariable\r\n  gv_EntitiesDead: graphedVariable\r\n\r\n  // Initialization\r\n\r\n  constructor(ctx: CanvasRenderingContext2D, options: boidEngineConfig = new boidEngineConfig()){\r\n    this.ctx = ctx\r\n\r\n    this.nEntities = new parameter(10, options.maxEntities, parameter_type.universal, 'nEntities')\r\n    this.nEntities.registerDependency(this._parameterUpdateHandler.bind(this))\r\n\r\n    let eps = parameter.getParameterByName('EntitySize')\r\n    this.entity_size = (eps)? eps :  new parameter(options.minEntitySize, options.maxEntitySize, parameter_type.entity_scoped, 'EntitySize')\r\n    this.entity_size.registerDependency(this._parameterUpdateHandler.bind(this))\r\n\r\n    this.entitiesToInfect = parameter.getParameterByNameOrCreate('# Infected at Start', parameter_type.universal, 0, 10)\r\n\r\n    this.continuum = options.continuum\r\n\r\n    let width:number = this.ctx.canvas.width\r\n    let height:number = this.ctx.canvas.height\r\n\r\n    this.size = new vec2(width, height)\r\n\r\n    this.bound_size = this.size.sub(this.entity_size.getValue()*4)\r\n    this._hbs = this.bound_size.scl(1/2)\r\n    this.entities = []\r\n\r\n    this._initBoids()\r\n\r\n    if(options.fps){\r\n      let frametime = 1000/options.fps;\r\n      this.startRenderInterval(frametime)\r\n      this.startUpdateInterval(frametime)\r\n      this.updateInterval = frametime;\r\n    }\r\n    this.gv_EntitiesAlive = graphedVariable.getGraphVariableByNameOrCreate('Entites Alive', '#198c19')\r\n    this.gv_EntitiesInfected = graphedVariable.getGraphVariableByNameOrCreate('Entites Infected' , '#73e500')\r\n    this.gv_EntitiesSick = graphedVariable.getGraphVariableByNameOrCreate('Entites Sick', '#ff4c4c')\r\n    this.gv_EntitesImmune = graphedVariable.getGraphVariableByNameOrCreate('Entites Immune', '#004c00')\r\n    this.gv_EntitiesDead = graphedVariable.getGraphVariableByNameOrCreate('Entities Dead', '#b20000')\r\n\r\n    window.addEventListener('resize', () => setTimeout(this.resizeEvent.bind(this), 10))\r\n  }\r\n\r\n  resizeEvent(){\r\n    let width:number = this.ctx.canvas.width\r\n    let height:number = this.ctx.canvas.height\r\n\r\n    this.size = new vec2(width, height)\r\n\r\n    this.bound_size = this.size.sub(this.entity_size.getValue()*4)\r\n    this._hbs = this.bound_size.scl(1/2)\r\n  }\r\n\r\n  infectOne(){\r\n    let idx = Math.floor(this.entities.length * Math.random())\r\n    this.entities[idx].setImmuneSystemState(sickness_state.incubating)\r\n  }\r\n\r\n  boidStateUpdateHandler(entity: boid, state: sickness_state){\r\n    // console.log(`boid #${entity.id} state is now: ${state}`)\r\n    if(state === sickness_state.deceased){\r\n      //console.log 'removing boid'\r\n      this.entitiesToBeRemoved.push(entity)\r\n    }\r\n  }\r\n\r\n  _generateNewBoid(){\r\n    let id = this.entities.length\r\n    // choose a new starting point randomly :)\r\n    let _x = Math.random()\r\n    let _y = Math.random()\r\n    let _pos = new vec2(_x, _y).scl(this.bound_size)\r\n\r\n    // generate a new entity\r\n    let _ent = new boid(_pos, this.entity_size, id)\r\n\r\n    _ent.onImmuneSystemStateUpdated = this.boidStateUpdateHandler.bind(this, _ent)\r\n\r\n    this.entities.push(_ent)\r\n  }\r\n\r\n  _initBoids(){\r\n    for(let i=0; i<this.nEntities.getValue(); i++){\r\n      this._generateNewBoid()\r\n    }\r\n    for(let i =0; i<this.entitiesToInfect.getValue(); i++){\r\n      this.infectOne()\r\n    }\r\n  }\r\n\r\n  _parameterUpdateHandler(param: parameter){\r\n    switch(param.name){\r\n      case 'nEntities':\r\n        let n = param.getValue()\r\n        let diff = n - this.entities.length\r\n        for(let i=0; i<Math.abs(diff); i++) (diff > 0)? this._generateNewBoid() : this.entities.pop()\r\n      break;\r\n      case 'EntitySize':\r\n        this.bound_size = this.size.sub(this.entity_size.getValue()*4)\r\n      break;\r\n    }\r\n  }\r\n\r\n  // Render/Update Intervals\r\n\r\n  startRenderInterval(interval: number){\r\n    if(this.renderIntervalID !== null){\r\n      clearInterval(this.renderIntervalID)\r\n    }\r\n    this.renderIntervalID = setInterval(this._render.bind(this), interval) as unknown as number\r\n  }\r\n\r\n  stopRenderInterval(){\r\n    if(this.renderIntervalID){\r\n      clearInterval(this.renderIntervalID)\r\n      this.renderIntervalID = null\r\n    }\r\n  }\r\n\r\n  startUpdateInterval(interval: number){\r\n    if(this.updateIntervalID !== null){\r\n      clearInterval(this.updateIntervalID)\r\n    }\r\n    this.updateIntervalID = setInterval(this._update.bind(this), interval) as unknown as number\r\n\r\n    this.updateInterval = interval\r\n  }\r\n\r\n  stopUpdateInterval(){\r\n    if(this.updateIntervalID){\r\n      clearInterval(this.updateIntervalID)\r\n      this.updateIntervalID = null\r\n    }\r\n  }\r\n\r\n  // interface Methods\r\n\r\n  reset(){\r\n    this.entities = []\r\n    this._initBoids()\r\n  }\r\n\r\n  addRule(_rule: boidRule){\r\n    console.log(_rule)\r\n    this.rules.push(_rule)\r\n  }\r\n\r\n  clearRules(){\r\n    this.rules = []\r\n  }\r\n\r\n  // Render/Update Methods\r\n\r\n  _render(){\r\n    this.ctx.clearRect(0, 0, this.ctx.canvas.width, this.ctx.canvas.height);\r\n\r\n    let id=0\r\n    for(let entity of this.entities){\r\n      this.ctx.beginPath();\r\n      this.ctx.arc(entity.position.x, entity.position.y, this.entity_size.getValue(id)/2, 0, 2 * Math.PI, false);\r\n      switch(entity.immuneState){\r\n        case sickness_state.cured:\r\n        this.ctx.fillStyle = '#004c00';\r\n        break;\r\n\r\n        case sickness_state.healthy:\r\n        this.ctx.fillStyle = '#198c19';\r\n        break;\r\n\r\n        case sickness_state.incubating:\r\n        this.ctx.fillStyle = '#ffff7f';\r\n        break;\r\n\r\n        case sickness_state.sick:\r\n        this.ctx.fillStyle = '#ff4c4c';\r\n        break;\r\n      }\r\n\r\n      this.ctx.fill();\r\n\r\n      this.ctx.beginPath();\r\n      this.ctx.strokeStyle = '#2a4e6c'\r\n      this.ctx.lineWidth = 0.3;\r\n      this.ctx.arc(entity.position.x, entity.position.y, this.entity_size.getValue(id)/2, 0, 2 * Math.PI);\r\n      this.ctx.stroke();\r\n      id ++\r\n    }\r\n  }\r\n\r\n  _updateGraphData(){\r\n    let nEntitesMax = this.nEntities.getValue()\r\n    let nAlive: number = this.entities.length\r\n    let nInfected: number = 0\r\n    let nSick: number = 0\r\n    let nImmune: number = 0\r\n    let nDead: number = nEntitesMax - this.entities.length\r\n\r\n    for(let ent of this.entities){\r\n      switch(ent.immuneState){\r\n        case sickness_state.cured:\r\n          nImmune ++\r\n          break;\r\n        case sickness_state.incubating:\r\n          nInfected ++\r\n          break;\r\n        case sickness_state.sick:\r\n          nSick ++\r\n          break;\r\n      }\r\n    }\r\n\r\n    this.gv_EntitiesAlive.appendValue(nAlive)\r\n    this.gv_EntitiesInfected.appendValue(nInfected)\r\n    this.gv_EntitiesSick.appendValue(nSick)\r\n    this.gv_EntitesImmune.appendValue(nImmune)\r\n    this.gv_EntitiesDead.appendValue(nDead)\r\n  }\r\n\r\n  _update(){\r\n    if(this.resetInNext){\r\n      this.entities = []\r\n      this._initBoids()\r\n      this.resetInNext = false;\r\n    }\r\n\r\n    if(this.entities.length > 0) this._updateGraphData();\r\n    for(let ent of this.entitiesToBeRemoved){\r\n      this.entities.splice(this.entities.indexOf(ent), 1)\r\n    }\r\n    this.entitiesToBeRemoved = []\r\n    //console.log('stepping panda')\r\n    let diff = this.updateInterval;\r\n    //TODO calulate distance matrix\r\n    let distMatrix = distanceAccelerator(this.entities)\r\n    //let rules_list = [rules.socialRule, rules.randomRule, rules.makeBorderRule(this.size)]\r\n\r\n    for(let entity of this.entities){\r\n      entity.update(diff, this.entities, distMatrix, this.rules)\r\n    }\r\n\r\n    if(this.continuum){\r\n      let id = 0\r\n      for(let entity of this.entities){\r\n        let point = entity.position\r\n        if(point.x < -this.entity_size){\r\n          entity.position.x += this.size.x + entity.size\r\n        }else if (point.x > (this.size.x + this.entity_size.getValue(id))){\r\n          entity.position.x -= this.size.x + entity.size\r\n        }\r\n\r\n        if(point.y < -this.entity_size){\r\n          entity.position.y += this.size.y + entity.size\r\n        }else if (point.y > (this.size.y + this.entity_size.getValue(id))){\r\n          entity.position.y -= this.size.y + entity.size\r\n        }\r\n        id ++\r\n      }\r\n    }\r\n  }\r\n\r\n  restart(){\r\n    console.log('restarting be')\r\n\r\n    this.resetInNext = true\r\n\r\n    this.gv_EntitiesAlive.resetData()\r\n    this.gv_EntitiesInfected.resetData()\r\n    this.gv_EntitiesSick.resetData()\r\n    this.gv_EntitesImmune.resetData()\r\n    this.gv_EntitiesDead.resetData()\r\n  }\r\n\r\n}\r\n\r\nlet limit = (min: number, max: number, val:number) => {\r\n  if(val < min) return min\r\n  if(val > max) return max\r\n  return val\r\n}\r\n\r\nlet limit_vec_len = (vec:vec2, limit:number) => {\r\n  let len = vec.len()\r\n  if(len>limit) return vec.norm().scl(limit)\r\n  return vec\r\n}\r\n\r\nexport class boid {\r\n  position: vec2\r\n  velocity: vec2 = new vec2()\r\n  state: string\r\n  _size: parameter\r\n\r\n  id: number\r\n\r\n  acceleration: parameter\r\n  speed: parameter\r\n\r\n  infection: sickness\r\n  ImmuneSystemStateUpdateHandler: any | null\r\n\r\n  constructor(pos: vec2 = new vec2(), size:parameter, id:number=0) {\r\n    this.position = pos\r\n    this._size = size\r\n    this.state = 'base'\r\n\r\n    this.id = id\r\n\r\n    this.acceleration = parameter.getParameterByNameOrCreate('Entity Acceleration', parameter_type.universal, 15, 25)\r\n    this.speed = parameter.getParameterByNameOrCreate('Entity Speed', parameter_type.universal, 15, 20)\r\n\r\n    this.infection = new sickness()\r\n  }\r\n\r\n  update(diff: number, entities:boid[], distanceMatrix:distanceElement[][], rules: boidRule[]){\r\n    let walk_dir = new vec2()\r\n\r\n    for(let idx=0; idx < rules.length; idx ++){\r\n      let rule = rules[idx]\r\n\r\n      // get the corresponding parameter :)\r\n      let rule_dir = rule.executeRule(this, entities, distanceMatrix)\r\n      rule_dir = rule.weightRule(rule_dir, this)\r\n      walk_dir = walk_dir.add(rule_dir)\r\n    }\r\n    let walk_acc = walk_dir.norm().scl(this.acceleration.getValue() * diff/1000)\r\n    this.velocity = this.velocity.add(walk_acc)\r\n    this.velocity = limit_vec_len(this.velocity, this.speed.getValue())\r\n\r\n    let new_position = this.position.add(this.velocity.scl(diff/1000))\r\n    // console.log(new_position.sub(this.position).len())\r\n\r\n    this.position = this._resolveCollisions(new_position, walk_dir, entities)\r\n\r\n    this.infection.update(diff)\r\n  }\r\n\r\n  inVirusVicinity(){\r\n    this.infection.inVirusVicinity()\r\n  }\r\n\r\n  setImmuneSystemState(state: sickness_state){\r\n    this.infection.state = state\r\n  }\r\n\r\n  // TODO move this to the engine :)\r\n  _resolveCollisions(newpos: vec2, walk_dir: vec2, entities:boid[]): vec2{\r\n    // could be sped up by only checking entities which were in the neighborhood before via max_walk_dist & distanceMatrix\r\n\r\n    let nEntities = entities.length\r\n\r\n    for(let i=0; i<nEntities; i++){\r\n      let entity = entities[i]\r\n      if(entity === this) continue\r\n      let dvec = entities[i].position.sub(newpos)\r\n      let len = dvec.len()\r\n\r\n      let mindist = this.size/2 + entities[i].size/2\r\n      if(len < mindist){\r\n        let resolve_vector = dvec.norm().scl(mindist - len)\r\n        // entities[i].position = entities[i].position.add(dvec.scl(0.25))\r\n        newpos = newpos.sub(resolve_vector)\r\n      }\r\n    }\r\n\r\n    return newpos\r\n  }\r\n\r\n  get size(): number{\r\n    return this._size.getValue(this.id)\r\n  }\r\n\r\n  get immuneState(){\r\n    return this.infection.state\r\n  }\r\n\r\n  set onImmuneSystemStateUpdated(callback: any){\r\n    this.infection.onStateUpdated = callback\r\n  }\r\n\r\n}\r\n\r\n/*\r\n\r\n\r\nsize: vec2\r\nbound_size: vec2\r\n_hbs: vec2\r\nentities: pandaEntity[]\r\n\r\nconstructor(ctx: CanvasRenderingContext2D, n: number){\r\n\r\n\r\n  this.ctx = ctx\r\n*/\r\n","var scope = (typeof global !== \"undefined\" && global) ||\n            (typeof self !== \"undefined\" && self) ||\n            window;\nvar apply = Function.prototype.apply;\n\n// DOM APIs, for completeness\n\nexports.setTimeout = function() {\n  return new Timeout(apply.call(setTimeout, scope, arguments), clearTimeout);\n};\nexports.setInterval = function() {\n  return new Timeout(apply.call(setInterval, scope, arguments), clearInterval);\n};\nexports.clearTimeout =\nexports.clearInterval = function(timeout) {\n  if (timeout) {\n    timeout.close();\n  }\n};\n\nfunction Timeout(id, clearFn) {\n  this._id = id;\n  this._clearFn = clearFn;\n}\nTimeout.prototype.unref = Timeout.prototype.ref = function() {};\nTimeout.prototype.close = function() {\n  this._clearFn.call(scope, this._id);\n};\n\n// Does not start the time, just sets up the members needed.\nexports.enroll = function(item, msecs) {\n  clearTimeout(item._idleTimeoutId);\n  item._idleTimeout = msecs;\n};\n\nexports.unenroll = function(item) {\n  clearTimeout(item._idleTimeoutId);\n  item._idleTimeout = -1;\n};\n\nexports._unrefActive = exports.active = function(item) {\n  clearTimeout(item._idleTimeoutId);\n\n  var msecs = item._idleTimeout;\n  if (msecs >= 0) {\n    item._idleTimeoutId = setTimeout(function onTimeout() {\n      if (item._onTimeout)\n        item._onTimeout();\n    }, msecs);\n  }\n};\n\n// setimmediate attaches itself to the global object\nrequire(\"setimmediate\");\n// On some exotic environments, it's not clear which object `setimmediate` was\n// able to install onto.  Search each possibility in the same order as the\n// `setimmediate` library.\nexports.setImmediate = (typeof self !== \"undefined\" && self.setImmediate) ||\n                       (typeof global !== \"undefined\" && global.setImmediate) ||\n                       (this && this.setImmediate);\nexports.clearImmediate = (typeof self !== \"undefined\" && self.clearImmediate) ||\n                         (typeof global !== \"undefined\" && global.clearImmediate) ||\n                         (this && this.clearImmediate);\n","(function (global, undefined) {\n    \"use strict\";\n\n    if (global.setImmediate) {\n        return;\n    }\n\n    var nextHandle = 1; // Spec says greater than zero\n    var tasksByHandle = {};\n    var currentlyRunningATask = false;\n    var doc = global.document;\n    var registerImmediate;\n\n    function setImmediate(callback) {\n      // Callback can either be a function or a string\n      if (typeof callback !== \"function\") {\n        callback = new Function(\"\" + callback);\n      }\n      // Copy function arguments\n      var args = new Array(arguments.length - 1);\n      for (var i = 0; i < args.length; i++) {\n          args[i] = arguments[i + 1];\n      }\n      // Store and register the task\n      var task = { callback: callback, args: args };\n      tasksByHandle[nextHandle] = task;\n      registerImmediate(nextHandle);\n      return nextHandle++;\n    }\n\n    function clearImmediate(handle) {\n        delete tasksByHandle[handle];\n    }\n\n    function run(task) {\n        var callback = task.callback;\n        var args = task.args;\n        switch (args.length) {\n        case 0:\n            callback();\n            break;\n        case 1:\n            callback(args[0]);\n            break;\n        case 2:\n            callback(args[0], args[1]);\n            break;\n        case 3:\n            callback(args[0], args[1], args[2]);\n            break;\n        default:\n            callback.apply(undefined, args);\n            break;\n        }\n    }\n\n    function runIfPresent(handle) {\n        // From the spec: \"Wait until any invocations of this algorithm started before this one have completed.\"\n        // So if we're currently running a task, we'll need to delay this invocation.\n        if (currentlyRunningATask) {\n            // Delay by doing a setTimeout. setImmediate was tried instead, but in Firefox 7 it generated a\n            // \"too much recursion\" error.\n            setTimeout(runIfPresent, 0, handle);\n        } else {\n            var task = tasksByHandle[handle];\n            if (task) {\n                currentlyRunningATask = true;\n                try {\n                    run(task);\n                } finally {\n                    clearImmediate(handle);\n                    currentlyRunningATask = false;\n                }\n            }\n        }\n    }\n\n    function installNextTickImplementation() {\n        registerImmediate = function(handle) {\n            process.nextTick(function () { runIfPresent(handle); });\n        };\n    }\n\n    function canUsePostMessage() {\n        // The test against `importScripts` prevents this implementation from being installed inside a web worker,\n        // where `global.postMessage` means something completely different and can't be used for this purpose.\n        if (global.postMessage && !global.importScripts) {\n            var postMessageIsAsynchronous = true;\n            var oldOnMessage = global.onmessage;\n            global.onmessage = function() {\n                postMessageIsAsynchronous = false;\n            };\n            global.postMessage(\"\", \"*\");\n            global.onmessage = oldOnMessage;\n            return postMessageIsAsynchronous;\n        }\n    }\n\n    function installPostMessageImplementation() {\n        // Installs an event handler on `global` for the `message` event: see\n        // * https://developer.mozilla.org/en/DOM/window.postMessage\n        // * http://www.whatwg.org/specs/web-apps/current-work/multipage/comms.html#crossDocumentMessages\n\n        var messagePrefix = \"setImmediate$\" + Math.random() + \"$\";\n        var onGlobalMessage = function(event) {\n            if (event.source === global &&\n                typeof event.data === \"string\" &&\n                event.data.indexOf(messagePrefix) === 0) {\n                runIfPresent(+event.data.slice(messagePrefix.length));\n            }\n        };\n\n        if (global.addEventListener) {\n            global.addEventListener(\"message\", onGlobalMessage, false);\n        } else {\n            global.attachEvent(\"onmessage\", onGlobalMessage);\n        }\n\n        registerImmediate = function(handle) {\n            global.postMessage(messagePrefix + handle, \"*\");\n        };\n    }\n\n    function installMessageChannelImplementation() {\n        var channel = new MessageChannel();\n        channel.port1.onmessage = function(event) {\n            var handle = event.data;\n            runIfPresent(handle);\n        };\n\n        registerImmediate = function(handle) {\n            channel.port2.postMessage(handle);\n        };\n    }\n\n    function installReadyStateChangeImplementation() {\n        var html = doc.documentElement;\n        registerImmediate = function(handle) {\n            // Create a <script> element; its readystatechange event will be fired asynchronously once it is inserted\n            // into the document. Do so, thus queuing up the task. Remember to clean up once it's been called.\n            var script = doc.createElement(\"script\");\n            script.onreadystatechange = function () {\n                runIfPresent(handle);\n                script.onreadystatechange = null;\n                html.removeChild(script);\n                script = null;\n            };\n            html.appendChild(script);\n        };\n    }\n\n    function installSetTimeoutImplementation() {\n        registerImmediate = function(handle) {\n            setTimeout(runIfPresent, 0, handle);\n        };\n    }\n\n    // If supported, we should attach to the prototype of global, since that is where setTimeout et al. live.\n    var attachTo = Object.getPrototypeOf && Object.getPrototypeOf(global);\n    attachTo = attachTo && attachTo.setTimeout ? attachTo : global;\n\n    // Don't get fooled by e.g. browserify environments.\n    if ({}.toString.call(global.process) === \"[object process]\") {\n        // For Node.js before 0.9\n        installNextTickImplementation();\n\n    } else if (canUsePostMessage()) {\n        // For non-IE10 modern browsers\n        installPostMessageImplementation();\n\n    } else if (global.MessageChannel) {\n        // For web workers, where supported\n        installMessageChannelImplementation();\n\n    } else if (doc && \"onreadystatechange\" in doc.createElement(\"script\")) {\n        // For IE 6–8\n        installReadyStateChangeImplementation();\n\n    } else {\n        // For older browsers\n        installSetTimeoutImplementation();\n    }\n\n    attachTo.setImmediate = setImmediate;\n    attachTo.clearImmediate = clearImmediate;\n}(typeof self === \"undefined\" ? typeof global === \"undefined\" ? this : global : self));\n","// shim for using process in browser\nvar process = module.exports = {};\n\n// cached from whatever global is present so that test runners that stub it\n// don't break things.  But we need to wrap it in a try catch in case it is\n// wrapped in strict mode code which doesn't define any globals.  It's inside a\n// function because try/catches deoptimize in certain engines.\n\nvar cachedSetTimeout;\nvar cachedClearTimeout;\n\nfunction defaultSetTimout() {\n    throw new Error('setTimeout has not been defined');\n}\nfunction defaultClearTimeout () {\n    throw new Error('clearTimeout has not been defined');\n}\n(function () {\n    try {\n        if (typeof setTimeout === 'function') {\n            cachedSetTimeout = setTimeout;\n        } else {\n            cachedSetTimeout = defaultSetTimout;\n        }\n    } catch (e) {\n        cachedSetTimeout = defaultSetTimout;\n    }\n    try {\n        if (typeof clearTimeout === 'function') {\n            cachedClearTimeout = clearTimeout;\n        } else {\n            cachedClearTimeout = defaultClearTimeout;\n        }\n    } catch (e) {\n        cachedClearTimeout = defaultClearTimeout;\n    }\n} ())\nfunction runTimeout(fun) {\n    if (cachedSetTimeout === setTimeout) {\n        //normal enviroments in sane situations\n        return setTimeout(fun, 0);\n    }\n    // if setTimeout wasn't available but was latter defined\n    if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {\n        cachedSetTimeout = setTimeout;\n        return setTimeout(fun, 0);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedSetTimeout(fun, 0);\n    } catch(e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally\n            return cachedSetTimeout.call(null, fun, 0);\n        } catch(e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error\n            return cachedSetTimeout.call(this, fun, 0);\n        }\n    }\n\n\n}\nfunction runClearTimeout(marker) {\n    if (cachedClearTimeout === clearTimeout) {\n        //normal enviroments in sane situations\n        return clearTimeout(marker);\n    }\n    // if clearTimeout wasn't available but was latter defined\n    if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {\n        cachedClearTimeout = clearTimeout;\n        return clearTimeout(marker);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedClearTimeout(marker);\n    } catch (e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally\n            return cachedClearTimeout.call(null, marker);\n        } catch (e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.\n            // Some versions of I.E. have different rules for clearTimeout vs setTimeout\n            return cachedClearTimeout.call(this, marker);\n        }\n    }\n\n\n\n}\nvar queue = [];\nvar draining = false;\nvar currentQueue;\nvar queueIndex = -1;\n\nfunction cleanUpNextTick() {\n    if (!draining || !currentQueue) {\n        return;\n    }\n    draining = false;\n    if (currentQueue.length) {\n        queue = currentQueue.concat(queue);\n    } else {\n        queueIndex = -1;\n    }\n    if (queue.length) {\n        drainQueue();\n    }\n}\n\nfunction drainQueue() {\n    if (draining) {\n        return;\n    }\n    var timeout = runTimeout(cleanUpNextTick);\n    draining = true;\n\n    var len = queue.length;\n    while(len) {\n        currentQueue = queue;\n        queue = [];\n        while (++queueIndex < len) {\n            if (currentQueue) {\n                currentQueue[queueIndex].run();\n            }\n        }\n        queueIndex = -1;\n        len = queue.length;\n    }\n    currentQueue = null;\n    draining = false;\n    runClearTimeout(timeout);\n}\n\nprocess.nextTick = function (fun) {\n    var args = new Array(arguments.length - 1);\n    if (arguments.length > 1) {\n        for (var i = 1; i < arguments.length; i++) {\n            args[i - 1] = arguments[i];\n        }\n    }\n    queue.push(new Item(fun, args));\n    if (queue.length === 1 && !draining) {\n        runTimeout(drainQueue);\n    }\n};\n\n// v8 likes predictible objects\nfunction Item(fun, array) {\n    this.fun = fun;\n    this.array = array;\n}\nItem.prototype.run = function () {\n    this.fun.apply(null, this.array);\n};\nprocess.title = 'browser';\nprocess.browser = true;\nprocess.env = {};\nprocess.argv = [];\nprocess.version = ''; // empty string to avoid regexp issues\nprocess.versions = {};\n\nfunction noop() {}\n\nprocess.on = noop;\nprocess.addListener = noop;\nprocess.once = noop;\nprocess.off = noop;\nprocess.removeListener = noop;\nprocess.removeAllListeners = noop;\nprocess.emit = noop;\nprocess.prependListener = noop;\nprocess.prependOnceListener = noop;\n\nprocess.listeners = function (name) { return [] }\n\nprocess.binding = function (name) {\n    throw new Error('process.binding is not supported');\n};\n\nprocess.cwd = function () { return '/' };\nprocess.chdir = function (dir) {\n    throw new Error('process.chdir is not supported');\n};\nprocess.umask = function() { return 0; };\n","import { parameter, parameter_type } from './utils'\r\n\r\nexport class ParameterControl {\r\n  controller: ParameterController\r\n  controlledParameter: parameter\r\n\r\n  minElement: HTMLInputElement|null = null\r\n  maxElement: HTMLInputElement|null = null\r\n  valueSlider: HTMLInputElement|null = null\r\n\r\n  constructor(controller: ParameterController, param: parameter){\r\n    this.controller = controller\r\n    this.controlledParameter = param\r\n    this.createUIElement()\r\n    this.attachListeners()\r\n  }\r\n\r\n  createUIElement(){\r\n    let listElem = document.createElement('li');\r\n    listElem.className = ''\r\n    let param_ctrl = document.createElement('div')\r\n    param_ctrl.className = 'param_options | no_select'\r\n    param_ctrl.innerText = this.controlledParameter.name + '\\n'\r\n\r\n    if(this.controlledParameter.type === parameter_type.entity_scoped ||\r\n       this.controlledParameter.type === parameter_type.universal){\r\n\r\n         let label_min: HTMLLabelElement = document.createElement('label')\r\n         label_min.htmlFor = `${this.controlledParameter.name}_min`\r\n         label_min.innerText = 'min:'\r\n         let input_min: HTMLInputElement = document.createElement('input')\r\n         input_min.name = `${this.controlledParameter.name}_min`\r\n         input_min.type = 'number'\r\n         input_min.value = this.controlledParameter.min + ''\r\n\r\n         let br_el = document.createElement('br')\r\n\r\n         let label_max: HTMLLabelElement = document.createElement('label')\r\n         label_max.htmlFor = `${this.controlledParameter.name}_max`\r\n         label_max.innerText = 'max:'\r\n         let input_max: HTMLInputElement = document.createElement('input')\r\n         input_max.name = `${this.controlledParameter.name}_max`\r\n         input_max.type = 'number'\r\n         input_max.value = this.controlledParameter.max + ''\r\n\r\n         this.minElement = input_min\r\n         this.maxElement = input_max\r\n\r\n         param_ctrl.appendChild(label_min)\r\n         param_ctrl.appendChild(input_min)\r\n         param_ctrl.appendChild(br_el)\r\n         param_ctrl.appendChild(label_max)\r\n         param_ctrl.appendChild(input_max)\r\n    }\r\n    listElem.appendChild(param_ctrl)\r\n\r\n    if(this.controlledParameter.type === parameter_type.universal ||\r\n       this.controlledParameter.type === parameter_type.universal_percentage){\r\n      let param_setpoint = document.createElement('div')\r\n      param_setpoint.className = 'param_setpoint'\r\n\r\n      let param_slider: HTMLInputElement = document.createElement('input')\r\n      param_slider.type = 'range'\r\n      param_slider.min = '0'\r\n      param_slider.max = '1000'\r\n      param_slider.value = '500'\r\n\r\n      param_setpoint.appendChild(param_slider)\r\n\r\n      listElem.appendChild(param_setpoint)\r\n      this.valueSlider = param_slider\r\n    }\r\n    this.controller.addUIElement(listElem)\r\n  }\r\n\r\n  attachListeners(){\r\n    if(this.minElement){\r\n      let _el: HTMLInputElement = this.minElement\r\n      this.minElement.onchange = () => { this.controlledParameter.setMin(parseInt(_el.value)) }\r\n    }\r\n\r\n    if(this.maxElement){\r\n      let _el: HTMLInputElement = this.maxElement\r\n      this.maxElement.onchange = () => { this.controlledParameter.setMax(parseInt(_el.value)) }\r\n    }\r\n\r\n    if(this.valueSlider){\r\n      let _el: HTMLInputElement = this.valueSlider\r\n      this.valueSlider.onchange = () => {\r\n        let val: number = parseInt(_el.value)/1000.0\r\n        val *= this.controlledParameter.max - this.controlledParameter.min\r\n        val += this.controlledParameter.min\r\n        this.controlledParameter.setValue(val)\r\n       }\r\n    }\r\n  }\r\n}\r\n\r\nexport class ParameterController {\r\n  parameter_container: HTMLElement\r\n  controlElements: ParameterControl[]\r\n\r\n  constructor(container: HTMLElement){\r\n    this.parameter_container = container\r\n    parameter.emitter.on('paramAdded', this.parameterAddHandler.bind(this))\r\n\r\n    this.controlElements = []\r\n  }\r\n\r\n  parameterAddHandler(param: parameter){\r\n    let _ctrl = new ParameterControl(this, param)\r\n    this.controlElements.push(_ctrl)\r\n  }\r\n\r\n  addUIElement(element: HTMLElement){\r\n    this.parameter_container.appendChild(element)\r\n  }\r\n\r\n}\r\n"],"sourceRoot":""}